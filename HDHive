#!name=HDHive 自动签到
#!desc=自动抓取Cookie并每日签到（支持抓取资料缓存+通知日志）。
#!author=ming
#!icon=https://hdhive.com/favicon.ico
#!homepage=https://hdhive.com/

[Argument]
RunTime = input,"0 6 * * *",tag=每日签到时间,desc=Cron表达式
CaptureCookie = switch,true,tag=[开关] 自动获取Cookie,desc=开启后访问网页自动抓取

[Script]
cron {RunTime} script-path=https://raw.githubusercontent.com/xhujer/-/refs/heads/main/HDHive%20Script, tag=HDHive每日签到, timeout=60, script-update-interval=86400

# 抓Cookie：拦常用入口 + 排除签到接口（避免循环）
http-request ^https?:\/\/(?:www\.)?hdhive\.com\/(?!api\/customer\/user\/checkin)(?:$|user\b|dashboard\b|api\/customer\b) script-path=https://raw.githubusercontent.com/xhujer/-/refs/heads/main/HDHive%20Script, tag=HDHive获取Cookie, timeout=10, requires-body=false, enable={CaptureCookie}, script-update-interval=86400

# 抓资料：必须 http-response + requires-body=true 才能拿到返回JSON
http-response ^https?:\/\/(?:www\.)?hdhive\.com\/api\/ script-path=https://raw.githubusercontent.com/xhujer/-/refs/heads/main/HDHive%20Script, tag=HDHive抓取资料, timeout=10, requires-body=true, enable={CaptureCookie}, script-update-interval=86400

[Mitm]
hostname = hdhive.com, www.hdhive.com