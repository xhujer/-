#!name=无忧行 - 去广告精简
#!desc=去除开屏/首页推荐/活动/埋点，精简底部Tab仅保留 电话 & 我的
#!author=明 & ChatGPT
#!openUrl=https://apps.apple.com/app/id1037589370
#!bundleId=com.cmi.jegotrip
#!tag=去广告
#!date=2025-08-27

[URL Rewrite]
# 开屏广告 / 推荐 / 活动
^https?:\/\/app3\.jegotrip\.com\.cn\/api\/(ad|promotion|activity|banner|recommend) url reject-dict
^https?:\/\/oss\.jegotrip\.com\.cn\/appSyncimage url reject
^https?:\/\/push\.it\.10086\.cn\/mc\/receipt\/iosBadge url reject

# 埋点/统计/日志
^https?:\/\/(umeng|bugly|sentry|bdstat|mtj|analytics)\. url reject

[Script]
# 精简底部Tab - 仅保留 电话 和 我的
^https?:\/\/app3\.jegotrip\.com\.cn\/api\/layout\/v\d+\/init\/tab script-response-body jegotrip_tab_filter.js

[MITM]
hostname = %APPEND% app3.jegotrip.com.cn, oss.jegotrip.com.cn, push.it.10086.cn

[Script Content]
#!name=jegotrip_tab_filter.js
#!desc=精简无忧行底部Tab，仅保留 电话 和 我的
#!author=明 & ChatGPT
#!arguments=

/***********************************************
 * 无忧行 Tab 精简脚本
 * 保留 “电话” & “我的” tab，其它全部删除
 ***********************************************/
let body = JSON.parse($response.body);

if (body && body.data && body.data.tabList) {
  body.data.tabList = body.data.tabList.filter(tab =>
    tab.name.includes("电话") || tab.name.includes("我的")
  );
}

$done({ body: JSON.stringify(body) });
