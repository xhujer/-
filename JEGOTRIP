#!name=无忧行去广告
#!desc=移除开屏广告、屏蔽首页推荐、精简首页和我的页面，保留核心功能
#!author=ZenmoFeiShi[https://github.com/ZenmoFeiShi]
#!tag=去广告
#!icon=https://imgtolinkx.com/i/CO0eIFoS
#!openUrl=https://apps.apple.com/app/id1037589370
#!bundleId=com.cmi.jegotrip
#!date=2025-08-26

[Rewrite]
// 首页和广告相关接口，用 JS 清理广告字段
^https?:\/\/app3\.jegotrip\.com\.cn\/api\/destination\/v1\/destination\/getDestinationById script-body=true,requires-body=true,tag=无忧行去广告
^https?:\/\/app3\.jegotrip\.com\.cn\/api\/layout\/v1\/init\/destinationModel script-body=true,requires-body=true,tag=无忧行去广告
^https?:\/\/app3\.jegotrip\.com\.cn\/api\/destination\/v1\/banner\/getDestBanners script-body=true,requires-body=true,tag=无忧行去广告
^https?:\/\/app3\.jegotrip\.com\.cn\/api\/destination\/v1\/rec\/queryData script-body=true,requires-body=true,tag=无忧行去广告
^https?:\/\/app3\.jegotrip\.com\.cn\/api\/destination\/v1\/rec\/columnListByRegion script-body=true,requires-body=true,tag=无忧行去广告
^https?:\/\/app3\.jegotrip\.com\.cn\/api\/destination\/v1\/poi\/queryJegoListAndNameByDestinationId script-body=true,requires-body=true,tag=无忧行去广告
^https?:\/\/push\.it\.10086\.cn\/mc\/receipt\/iosBadge script-body=true,requires-body=true,tag=无忧行去广告
^https?:\/\/oss\.jegotrip\.com\.cn\/appSyncimage script-body=true,requires-body=true,tag=无忧行去广告

[MitM]
hostname=app3.jegotrip.com.cn,push.it.10086.cn,oss.jegotrip.com.cn

[Script]
// -------- 内置 JS 脚本内容（script-body） --------
try {
    let body = JSON.parse($response.body);

    // 删除首页广告模块
    if (body.data) {
        delete body.data.bannerList;
        delete body.data.recommend;
        delete body.data.columnListByRegion;
        delete body.data.poiList;
    }

    // 删除我的页面广告
    if (body.data?.userCenter) {
        delete body.data.userCenter.ads;
    }

    // 保留核心数据（电话、用户信息等）
    // 可根据需要调整，如保留 body.data.userCenter.profile

    $done({ body: JSON.stringify(body) });
} catch(e) {
    $done({}); // 出错返回空
}
