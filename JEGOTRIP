#!name=无忧行去广告
#!desc=移除开屏广告、屏蔽首页推荐、精简首页 & 我的页面广告
#!tag=去广告
#!icon=https://imgtolinkx.com/i/CO0eIFoS
#!openUrl=https://apps.apple.com/app/id1037589370
#!bundleId=com.cmi.jegotrip
#!date=2025-08-27

[Rule]
# 屏蔽广告接口和推荐
DOMAIN,app3.jegotrip.com.cn,REJECT
# 屏蔽推送和广告资源
DOMAIN,push.it.10086.cn,REJECT
DOMAIN,oss.jegotrip.com.cn,REJECT

[Rewrite]
# 首页接口阻断
^https?:\/\/app3\.jegotrip\.com\.cn\/api\/destination\/v1\/destination\/getDestinationById reject-dict
^https?:\/\/app3\.jegotrip\.com\.cn\/api\/layout\/v1\/init\/destinationModel reject-dict
^https?:\/\/app3\.jegotrip\.com\.cn\/api\/destination\/v1\/banner\/getDestBanners reject-dict
^https?:\/\/app3\.jegotrip\.com\.cn\/api\/destination\/v1\/queryGlobalStrategyData reject-dict
^https?:\/\/app3\.jegotrip\.com\.cn\/api\/destination\/v1\/rec\/columnListByRegion reject-dict
^https?:\/\/app3\.jegotrip\.com\.cn\/api\/destination\/v1\/poi\/queryJegoListAndNameByDestinationId reject-dict
^https?:\/\/app3\.jegotrip\.com\.cn\/api\/destination\/v1\/rec\/queryData reject-dict

# 广告图片资源
^https?:\/\/oss\.jegotrip\.com\.cn\/appSyncimage reject-dict

[Script]
// 清理首页和我的页面广告模块
http-response ^https?:\/\/app3\.jegotrip\.com\.cn\/api\/destination\/v1\/destination\/getDestinationById script-body=true,requires-body=true,tag=无忧行去广告
http-response ^https?:\/\/app3\.jegotrip\.com\.cn\/api\/layout\/v1\/init\/destinationModel script-body=true,requires-body=true,tag=无忧行去广告

[MitM]
hostname=app3.jegotrip.com.cn,push.it.10086.cn,oss.jegotrip.com.cn

// -------- 内置 JS 脚本内容 --------
let body;
try {
    body = JSON.parse($response.body);
} catch(e) {
    $done({});
}

// 删除首页广告模块
if (body && body.data) {
    delete body.data.bannerList;
    delete body.data.recommend;
    delete body.data.columnListByRegion;
    delete body.data.poiList;
    delete body.data.promotionList;
    delete body.data.strategyList;
}

// 删除“我的页面”广告
if (body && body.data && body.data.userCenter) {
    delete body.data.userCenter.ads;
    delete body.data.userCenter.bannerList;
}

$done({ body: JSON.stringify(body) });
